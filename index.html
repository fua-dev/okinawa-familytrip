<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>沖繩之旅 2026 - 7人家族旅行</title>
    <!-- Tailwind CSS 3.4 CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&family=Noto+Serif+TC:wght@700&display=swap" rel="stylesheet">
    <!-- React & Babel CDN -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://unpkg.com/lucide-react@latest/dist/umd/lucide-react.min.js"></script>
    <!-- Framer Motion -->
    <script src="https://unpkg.com/framer-motion@11.0.8/dist/framer-motion.js"></script>

    <style>
        :root {
            --morandi-blue: #A2B2B8;
            --morandi-grey: #DCD9D4;
            --morandi-sand: #F5F4F0;
            --morandi-pink: #C8A9A2;
            --morandi-dark: #9A9FA1;
            --text-main: #555555;
            --text-muted: #A0A0A0;
        }

        body {
            background-color: #F0EEE9;
            color: var(--text-main);
            font-family: 'Noto Sans TC', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        .font-serif { font-family: 'Noto Serif TC', serif; }

        h1, h2, h3, h4, .font-serif {
            font-family: 'Noto Serif TC', serif;
        }

        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        .glass-card {
            background: white;
            border-radius: 28px;
            border: 1px solid rgba(255, 255, 255, 0.8);
            box-shadow: 0 8px 24px rgba(0,0,0,0.02);
        }

        .bg-morandi-blue { background-color: var(--morandi-blue); }
        .bg-morandi-sand { background-color: var(--morandi-sand); }
        .bg-morandi-pink { background-color: var(--morandi-pink); }
        .text-morandi-blue { color: var(--morandi-blue); }
        .text-morandi-dark { color: var(--morandi-dark); }
        .text-morandi-pink { color: var(--morandi-pink); }
        .text-text-main { color: var(--text-main); }
        .text-text-muted { color: var(--text-muted); }
        .border-morandi-sand { border-color: var(--morandi-sand); }
        .border-morandi-pink { border-color: var(--morandi-pink); }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo } = React;
        const { motion, AnimatePresence } = window.Motion;
        const { 
            Calendar, Wallet, ListCheck, Info, Plane, Car, Utensils, Camera, Bed, MapPin, 
            CloudSun, Cloud, Sun, CloudRain, Plus, Trash2, ChevronRight, Navigation, X, 
            Image as ImageIcon, LayoutGrid, StretchHorizontal, Phone, AlertTriangle, 
            ExternalLink, Smartphone, Users, CheckCircle2, Circle, Clock, Ticket,
            Wallet as WalletIcon
        } = LucideReact;

        // --- Data ---
        const ITINERARY_DATA = [
            { 
                day: 1, date: "2026-07-13", week: "MON", 
                items: [
                    { id: '1-1', time: "09:00", type: "transport", title: "桃園機場第一航廈會合", detail: "星宇航空櫃檯集合，檢查護照與日文譯本。", address: "桃園市大園區航站南路15號", content: "各位貴賓早安！我們即將展開期待已久的沖繩之旅。請大家再次確認護照、日文譯本以及最重要的心情都帶齊了嗎？第一站我們先在星宇櫃檯集合辦理登機。", links: [{ label: "機捷路線及時刻表", url: "https://www.tymetro.com.tw/tymetro-new/tw/_pages/travel-guide/timetable.php", icon: "Clock" }] },
                    { id: '1-2', time: "15:00", type: "flight", title: "抵達那霸空港 & 租車", detail: "預計抵達後分頭行動：租車取車、飯店入住。", address: "那霸機場", content: "抵達後約 15:30 進行租車行程。請搭乘機場接駁車前往營業所辦理手續。" },
                    { id: '1-3', time: "16:00", type: "stay", title: "那霸歌町大和Roynet飯店PREMIER", detail: "Check-in 放置行李。", address: "那霸市安里1-1-1", bookingInfo: { hotelName: "Daiwa Roynet Hotel Naha Omoromachi PREMIER", checkIn: "2026-07-13", checkOut: "2026-07-17" }, content: "飯店位於那霸新都心，地理位置極佳。對面就有百貨公司，周邊購物與餐飲選擇非常豐富。" },
                    { id: '1-4', time: "17:00", type: "spot", title: "國際通散策", detail: "探索那霸最熱鬧的街道。", address: "那霸市國際通", content: "國際通是那霸的心臟地帶。推薦美食：Pork Tamago Onigiri (飯糰)、Blue Seal 冰淇淋。" },
                    { id: '1-5', time: "17:30", type: "food", title: "晚餐：暖暮拉麵", detail: "品嚐道地九州拉麵。", address: "那霸市牧志2-16-10", content: "雖然是九州體系，但在沖繩可是人氣爆棚。" }
                ]
            },
            { 
                day: 2, date: "2026-07-14", week: "TUE", 
                items: [
                    { id: '2-0', time: "08:00", type: "food", title: "飯店早餐", detail: "享用飯店美味早餐後出發。", content: "開啟活力的一天。" },
                    { id: '2-1', time: "08:30", type: "spot", title: "西來院達摩寺", detail: "祈福參拜。", address: "那霸市首里赤田町1-5-1", content: "西來院是首里著名的寺院，環境清幽。" },
                    { id: '2-2', time: "10:00", type: "spot", title: "古宇利島", detail: "跨海大橋美景。", address: "今歸仁村古宇利", content: "這條橋被稱為『沖繩最美跨海大橋』。" },
                    { id: '2-3', time: "12:00", type: "food", title: "午餐：百年古家 大家", detail: "享用阿古豬料理。", address: "名護市中山90", content: "在古色古香的環境中品嚐沖繩特有的阿古豬。" },
                    { id: '2-4', time: "14:00", type: "spot", title: "美麗海水族館", detail: "觀賞黑潮之海。", address: "本部町石川424", content: "世界前三大的水族館，震撼感十足。" },
                    { id: '2-5', time: "18:00", type: "food", title: "晚餐：燒肉五苑", detail: "吃到飽燒肉。", address: "名護市為又479-5", content: "慶祝旅途愉快，請務必準時抵達訂位。" }
                ]
            },
            { day: 3, date: "2026-07-15", week: "WED", items: [{ id: '3-1', time: "09:00", type: "spot", title: "東南植物園", detail: "漫步熱帶植物園。", address: "沖繩市知花2146", content: "擁有豐富的熱帶植物，還有可愛動物互動。" }] },
            { 
                day: 4, 
                date: "2026-07-16", 
                week: "THU", 
                items: [
                    { id: '4-0', time: "08:00", type: "food", title: "飯店早餐", detail: "享用早餐。", content: "最後一天的全日行程，吃飽再出發。" },
                    { id: '4-1', time: "09:00", type: "spot", title: "DMM Kariyushi 水族館", detail: "沉浸式水族館體驗。", address: "豐見城市豐崎3-35", content: "結合影像技術與空間設計的現代水族館。餵食秀時間：10:00/11:00 樹懶；10:30 企鵝。", links: [{ label: "餵食秀時刻表", url: "https://tc.kariyushi-aquarium.com/time-schedule/", icon: "Clock" }] },
                    { id: '4-2', time: "12:00", type: "food", title: "午餐：iiAS 沖繩豐崎", detail: "水族館旁的購物中心用餐。", address: "豐見城市豐崎3-35", content: "iiAS 購物中心內有多樣化的美食街與餐廳選擇，用餐後還能繼續逛街。" },
                    { id: '4-3', time: "14:00", type: "spot", title: "沖繩世界文化王國", detail: "玉泉洞與傳統文化體驗。", address: "南城市玉城前川1336", content: "擁有日本三大鐘乳石洞之一的『玉泉洞』。園區內還有琉球玻璃製作、傳統舞蹈表演等文化體驗。", links: [{ label: "表演時刻表及體驗項目", url: "https://www.gyokusendo.co.jp.t.aqs.hp.transer.com/okinawaworld/showtime/", icon: "ExternalLink" }] },
                    { id: '4-4', time: "17:00", type: "food", title: "晚餐：奧武島中本鮮魚天婦羅", detail: "享用美味天婦羅。", address: "南城市玉城奧武9", phone: "098-948-4307", content: "奧武島上著名的天婦羅店，現炸美味。推薦：鮮魚、花枝、海蘊天婦羅。" }
                ]
            },
            { 
                day: 5, 
                date: "2026-07-17", 
                week: "FRI", 
                items: [
                    { id: '5-0', time: "08:00", type: "food", title: "飯店早餐", detail: "最後一次享用飯店早餐。", content: "整理行李，準備退房。" },
                    { id: '5-1', time: "08:30", type: "spot", title: "波上宮 & 逛街", detail: "懸崖上的神社，最後採買。", address: "那霸市若狹1-25-11", content: "波上宮是琉球八社之首，建在懸崖之上，俯瞰波之上海灘。參拜後可以進行最後的市區採買。" },
                    { id: '5-2', time: "12:00", type: "food", title: "午餐", detail: "簡單午餐。", content: "在前往機場前享用簡單的午餐。" },
                    { id: '5-3', time: "12:30", type: "transport", title: "前往機場候機", detail: "辦理登機手續。", address: "那霸機場", content: "請預留充足時間辦理退稅與登機手續。" },
                    { id: '5-4', time: "18:00", type: "transport", title: "返家", detail: "抵達台灣，平安回家。", content: "結束愉快的 5 天 4 夜沖繩之旅，帶著滿滿的回憶回家。" }
                ]
            }
        ];

        // --- App Component ---
        function App() {
            const [activeTab, setActiveTab] = useState('schedule');
            const [currentDay, setCurrentDay] = useState(1);
            const [selectedItem, setSelectedItem] = useState(null);
            const [showDeclaration, setShowDeclaration] = useState(false);
            const [expenses, setExpenses] = useState([]);
            const [shoppingList, setShoppingList] = useState([]);
            const [shopLayout, setShopLayout] = useState('grid');
            const [memo, setMemo] = useState('');
            const [exchangeRate, setExchangeRate] = useState(0.21);

            useEffect(() => {
                const fetchRate = async () => {
                    try {
                        const response = await fetch('https://open.er-api.com/v6/latest/JPY');
                        const data = await response.json();
                        if (data && data.rates && data.rates.TWD) {
                            setExchangeRate(data.rates.TWD);
                        }
                    } catch (error) {
                        console.error('Failed to fetch exchange rate:', error);
                    }
                };
                fetchRate();
            }, []);

            useEffect(() => {
                const savedExp = localStorage.getItem('okinawa_expenses');
                if (savedExp) setExpenses(JSON.parse(savedExp));
                const savedShop = localStorage.getItem('okinawa_shopping');
                if (savedShop) setShoppingList(JSON.parse(savedShop));
                const savedMemo = localStorage.getItem('okinawa_memo');
                if (savedMemo) setMemo(savedMemo);
            }, []);

            useEffect(() => { localStorage.setItem('okinawa_expenses', JSON.stringify(expenses)); }, [expenses]);
            useEffect(() => { localStorage.setItem('okinawa_shopping', JSON.stringify(shoppingList)); }, [shoppingList]);
            useEffect(() => { localStorage.setItem('okinawa_memo', memo); }, [memo]);

            const weatherForecast = useMemo(() => {
                const data = [];
                const conditions = ['sun', 'cloud-sun', 'cloud', 'rain'];
                for (let i = 0; i < 24; i++) {
                    const hour = (new Date().getHours() + i) % 24;
                    data.push({
                        time: `${hour.toString().padStart(2, '0')}:00`,
                        temp: 28 + Math.floor(Math.random() * 5),
                        condition: conditions[Math.floor(Math.random() * conditions.length)]
                    });
                }
                return data;
            }, []);

            return (
                <div className="max-w-[480px] mx-auto min-h-screen bg-morandi-sand relative pb-24">
                    <header className="pt-6 pb-4 text-center relative px-6">
                        <p className="text-[10px] tracking-[0.4em] text-morandi-dark uppercase mb-2 font-serif">Okinawa Family Trip</p>
                        <div className="relative inline-block">
                            <h1 className="font-serif text-3xl font-bold tracking-tight text-text-main">沖繩之旅 <span className="text-base font-bold opacity-40">2026</span></h1>
                        </div>
                        {/* Decorative Dots - Stretched to card width */}
                        <div className="flex justify-between items-center w-full mt-2 px-2">
                            {[...Array(16)].map((_, i) => (
                                <div key={i} className="w-1 h-1 rounded-full bg-morandi-blue/30" />
                            ))}
                        </div>
                        <button onClick={() => setShowDeclaration(true)} className="absolute right-20 top-8 w-10 h-10 rounded-full bg-white shadow-sm flex items-center justify-center text-morandi-blue active:scale-95 transition-all z-10">
                            <Users size={20} />
                        </button>
                    </header>

                    <AnimatePresence>
                        {showDeclaration && (
                            <div className="fixed inset-0 z-[110] flex items-center justify-center bg-black/40 backdrop-blur-sm p-6">
                                <motion.div initial={{ opacity: 0, scale: 0.9 }} animate={{ opacity: 1, scale: 1 }} exit={{ opacity: 0, scale: 0.9 }} className="w-full max-w-[360px] bg-white rounded-[40px] p-10 shadow-2xl relative text-center">
                                    <button onClick={() => setShowDeclaration(false)} className="absolute top-6 right-6 text-gray-200"><X size={24} /></button>
                                    <div className="w-16 h-16 bg-morandi-sand rounded-full flex items-center justify-center mx-auto mb-6 text-morandi-blue"><Users size={32} /></div>
                                    <h3 className="font-serif text-2xl font-bold text-text-main mb-6">家族旅遊宣言</h3>
                                    <div className="space-y-4 text-sm text-text-main leading-relaxed">
                                        <p>「累了就休息，肚子餓了就吃飯，想上廁所馬上說。」</p>
                                        <p>「每天一張合照：留下 7 人的沖繩記憶。」</p>
                                        <p>「四大三小，平安出門，快樂回家。」</p>
                                    </div>
                                    <button onClick={() => setShowDeclaration(false)} className="mt-10 w-full py-4 bg-morandi-blue text-white rounded-2xl font-bold tracking-widest">出發！</button>
                                </motion.div>
                            </div>
                        )}
                    </AnimatePresence>

                    <main className="px-6">
                        {activeTab === 'schedule' && <ScheduleTab currentDay={currentDay} setCurrentDay={setCurrentDay} setSelectedItem={setSelectedItem} weatherForecast={weatherForecast} />}
                        {activeTab === 'budget' && <BudgetTab expenses={expenses} setExpenses={setExpenses} rate={exchangeRate} />}
                        {activeTab === 'list' && <ShoppingTab list={shoppingList} setList={setShoppingList} layout={shopLayout} setLayout={setShopLayout} memo={memo} setMemo={setMemo} />}
                        {activeTab === 'info' && <InfoTab />}
                    </main>

                    <nav className="fixed bottom-0 left-1/2 -translate-x-1/2 w-full max-w-[480px] bg-white/95 backdrop-blur-xl border-t border-gray-100 rounded-t-[32px] px-6 py-4 flex justify-around items-center shadow-[0_-10px_30px_rgba(0,0,0,0.03)] z-50">
                        <NavButton active={activeTab === 'schedule'} onClick={() => setActiveTab('schedule')} icon={<Calendar size={20} />} label="行程" />
                        <NavButton active={activeTab === 'budget'} onClick={() => setActiveTab('budget')} icon={<Wallet size={20} />} label="記帳" />
                        <NavButton active={activeTab === 'list'} onClick={() => setActiveTab('list')} icon={<ListCheck size={20} />} label="清單" />
                        <NavButton active={activeTab === 'info'} onClick={() => setActiveTab('info')} icon={<Info size={20} />} label="資訊" />
                    </nav>

                    <AnimatePresence>{selectedItem && <GuideModal item={selectedItem} onClose={() => setSelectedItem(null)} />}</AnimatePresence>
                </div>
            );
        }

        // --- Sub-Components ---
        function NavButton({ active, onClick, icon, label }) {
            return (
                <button onClick={onClick} className={`flex flex-col items-center gap-1.5 transition-all duration-300 ${active ? 'text-morandi-blue' : 'text-text-muted'}`}>
                    <motion.div animate={{ y: active ? -4 : 0 }}>{icon}</motion.div>
                    <span className={`text-[11px] font-medium tracking-widest ${active ? 'opacity-100' : 'opacity-60'}`}>{label}</span>
                </button>
            );
        }

        function ScheduleTab({ currentDay, setCurrentDay, setSelectedItem, weatherForecast }) {
            return (
                <div className="space-y-6">
                    <div className="flex justify-between px-2 py-2 gap-2 hide-scrollbar">
                        {ITINERARY_DATA.map(d => (
                            <button key={d.day} onClick={() => setCurrentDay(d.day)} className="flex flex-col items-center min-w-[60px]">
                                <span className={`text-[10px] font-bold tracking-widest font-serif ${currentDay === d.day ? 'text-morandi-blue' : 'text-gray-300'}`}>{d.week}</span>
                                <span className={`font-serif text-2xl mt-1 ${currentDay === d.day ? 'font-bold text-text-main' : 'text-gray-300'}`}>{d.date.split('-')[2]}</span>
                                {currentDay === d.day && <div className="w-1.5 h-1.5 rounded-full bg-morandi-pink mt-2" />}
                            </button>
                        ))}
                    </div>

                    <div className="space-y-3">
                        <div className="flex items-center justify-between px-1">
                            <h3 className="text-xs font-bold text-morandi-dark uppercase flex items-center gap-2"><CloudSun size={14} /> 沖繩市 24H 預報</h3>
                            <span className="text-[10px] text-gray-400">滑動連動行程</span>
                        </div>
                        <div className="flex overflow-x-auto gap-3 pb-4 hide-scrollbar snap-x">
                            {weatherForecast.map((w, i) => (
                                <div key={i} className="flex flex-col items-center gap-2 bg-white/60 backdrop-blur-sm p-3 rounded-2xl min-w-[70px] border border-white/80 shadow-sm snap-start">
                                    <span className="text-[10px] font-mono text-gray-400">{w.time}</span>
                                    <span className="text-sm font-bold text-text-main">{w.temp}°</span>
                                </div>
                            ))}
                        </div>
                    </div>

                    <div className="space-y-4">
                        {ITINERARY_DATA.find(d => d.day === currentDay)?.items.map((item) => (
                            <div key={item.id} onClick={() => setSelectedItem(item)} className="glass-card p-5 flex items-center gap-5 cursor-pointer active:scale-[0.98] transition-all">
                                <div className="text-center min-w-[50px]">
                                    <div className="text-lg font-serif font-bold text-text-main">{item.time}</div>
                                </div>
                                <div className="h-10 w-px bg-gray-100" />
                                <div className="flex-1 min-w-0">
                                    <h4 className="font-serif font-bold text-text-main truncate">{item.title}</h4>
                                    <p className="text-[11px] text-text-muted truncate">{item.detail}</p>
                                </div>
                                <ChevronRight size={16} className="text-gray-200" />
                            </div>
                        ))}
                    </div>
                </div>
            );
        }

        function GuideModal({ item, onClose }) {
            return (
                <div className="fixed inset-0 z-[100] flex items-end justify-center bg-black/40 backdrop-blur-sm p-4">
                    <motion.div initial={{ y: '100%' }} animate={{ y: 0 }} exit={{ y: '100%' }} className="w-full max-w-[480px] bg-white rounded-t-[40px] p-8 pb-12 shadow-2xl relative max-h-[90vh] overflow-y-auto hide-scrollbar">
                        <button onClick={onClose} className="absolute top-6 right-8 text-gray-200"><X size={28} /></button>
                        <div className="text-center mb-8">
                            <span className="px-3 py-1 bg-morandi-sand text-morandi-blue text-[10px] font-bold uppercase rounded-full">{item.type}</span>
                            <h2 className="font-serif text-3xl font-bold mt-4 text-text-main">{item.title}</h2>
                        </div>
                        <div className="space-y-6">
                            <div className="bg-morandi-sand/50 p-6 rounded-[32px] space-y-4 text-sm">
                                <div className="flex items-center gap-3"><MapPin size={16} className="text-morandi-blue" /><span>{item.address || "詳見地圖"}</span></div>
                                <div className="flex items-center gap-3"><Clock size={16} className="text-morandi-blue" /><span>{item.time}</span></div>
                            </div>
                            <div className="text-sm leading-relaxed text-text-main bg-white border border-morandi-sand p-6 rounded-[32px] shadow-sm">{item.content}</div>
                            <button onClick={() => window.open(`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(item.address || item.title)}`)} className="w-full py-5 bg-morandi-blue text-white rounded-2xl font-bold tracking-[0.4em] flex items-center justify-center gap-3 shadow-lg">
                                <Navigation size={20} /> 開啟導航
                            </button>
                        </div>
                    </motion.div>
                </div>
            );
        }

        function BudgetTab({ expenses, setExpenses, rate }) {
            const [title, setTitle] = useState('');
            const [amount, setAmount] = useState('');
            const [calcInput, setCalcInput] = useState('');

            const totalJPY = expenses.reduce((sum, e) => sum + e.amount, 0);
            const totalTWD = Math.round(totalJPY * rate);

            const calcResult = useMemo(() => {
                try {
                    const clean = calcInput.replace(/[^0-9+\-*/().]/g, '');
                    if (!clean) return 0;
                    return eval(clean) || 0;
                } catch {
                    return 0;
                }
            }, [calcInput]);

            const addExpense = () => {
                if (!title || !amount) return;
                setExpenses([{ 
                    id: Date.now().toString(), 
                    title, 
                    amount: parseFloat(amount), 
                    time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }) 
                }, ...expenses]);
                setTitle(''); setAmount('');
            };

            const removeExpense = (id) => {
                setExpenses(expenses.filter(e => e.id !== id));
            };

            return (
                <div className="space-y-6">
                    {/* Input Card */}
                    <div className="glass-card p-6 space-y-5 relative">
                        <div className="flex items-center gap-3">
                            <div className="w-10 h-10 bg-morandi-blue/10 rounded-xl flex items-center justify-center text-morandi-blue">
                                <WalletIcon size={20} />
                            </div>
                            <h3 className="font-serif text-2xl font-bold text-text-main">旅行帳本</h3>
                        </div>

                        <div className="space-y-4">
                            <div className="bg-white/60 p-5 rounded-[24px] border border-morandi-sand shadow-inner">
                                <label className="text-[10px] text-morandi-dark block mb-2 tracking-widest uppercase font-bold">即時換算 (1 JPY ≈ {rate.toFixed(4)} TWD)</label>
                                <div className="flex items-center gap-2">
                                    <span className="text-lg font-mono text-morandi-blue">¥</span>
                                    <input 
                                        value={calcInput}
                                        onChange={(e) => setCalcInput(e.target.value)}
                                        placeholder="輸入算式 (如 1500+200)..." 
                                        className="w-full bg-transparent text-xl font-mono outline-none text-text-main"
                                    />
                                </div>
                                <div className="text-right text-xs mt-2 text-morandi-dark font-medium bg-morandi-sand/50 inline-block px-3 py-1 rounded-full float-right">
                                    ≈ $ {Math.round(calcResult * rate).toLocaleString()} TWD
                                </div>
                                <div className="clear-both" />
                            </div>

                            <div className="flex flex-col gap-3">
                                <input 
                                    value={title}
                                    onChange={(e) => setTitle(e.target.value)}
                                    placeholder="項目名稱" 
                                    className="w-full p-4 bg-morandi-sand/50 rounded-2xl outline-none text-sm border border-transparent focus:border-morandi-blue/30 transition-all"
                                />
                                <div className="flex gap-3">
                                    <input 
                                        type="number"
                                        value={amount}
                                        onChange={(e) => setAmount(e.target.value)}
                                        placeholder="金額 (JPY)" 
                                        className="flex-1 p-4 bg-morandi-sand/50 rounded-2xl outline-none text-sm border border-transparent focus:border-morandi-blue/30 transition-all font-mono"
                                    />
                                    <button 
                                        onClick={addExpense}
                                        className="px-8 bg-morandi-blue text-white rounded-2xl text-sm font-bold tracking-widest shadow-lg shadow-morandi-blue/20 active:scale-95 transition-all flex items-center justify-center"
                                    >
                                        <Plus size={18} />
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Summary & History Card */}
                    <div className="glass-card p-6 space-y-6">
                        <div className="grid grid-cols-2 gap-4">
                            <div className="bg-morandi-sand/80 p-5 rounded-[24px] border border-white/50">
                                <p className="text-[10px] text-morandi-dark mb-1 uppercase tracking-widest font-bold">Total JPY</p>
                                <p className="text-2xl font-mono font-bold text-text-main">¥{totalJPY.toLocaleString()}</p>
                            </div>
                            <div className="bg-morandi-pink/10 p-5 rounded-[24px] border border-morandi-pink/10">
                                <p className="text-[10px] text-morandi-pink mb-1 uppercase tracking-widest font-bold">Total TWD</p>
                                <p className="text-2xl font-mono font-bold text-morandi-pink">${totalTWD.toLocaleString()}</p>
                            </div>
                        </div>

                        <div className="space-y-0.5">
                            <div className="flex items-center justify-between px-2 mb-3">
                                <h4 className="text-xs font-bold text-morandi-dark uppercase tracking-widest">支出明細</h4>
                                <span className="text-[10px] text-text-muted">{expenses.length} 筆紀錄</span>
                            </div>
                            
                            <div className="bg-[#FFF9E5] rounded-2xl p-4 shadow-sm border border-[#F0E6C0] relative">
                                {expenses.length === 0 ? (
                                    <p className="text-center py-8 text-sm text-[#B0A680] italic">尚無支出紀錄</p>
                                ) : (
                                    <div className="space-y-0">
                                        {expenses.map((ex, idx) => (
                                            <div 
                                                key={ex.id} 
                                                className={`flex items-center justify-between py-2.5 ${idx !== expenses.length - 1 ? 'border-b border-[#F0E6C0]/60' : ''}`}
                                            >
                                                <div className="flex-1 min-w-0 pr-4">
                                                    <h5 className="text-sm font-bold text-[#5D5740] truncate leading-tight">{ex.title}</h5>
                                                    <p className="text-[10px] text-[#A09980] font-mono leading-tight">{ex.time}</p>
                                                </div>
                                                <div className="flex items-center gap-3">
                                                    <div className="text-right">
                                                        <p className="font-mono text-sm font-bold text-[#5D5740] leading-tight">¥{ex.amount.toLocaleString()}</p>
                                                        <p className="text-[9px] text-[#A09980] leading-tight">≈ ${Math.round(ex.amount * rate)}</p>
                                                    </div>
                                                    <button onClick={() => removeExpense(ex.id)} className="text-[#D0C9B0] hover:text-morandi-pink transition-colors p-1">
                                                        <Trash2 size={14} />
                                                    </button>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        function ShoppingTab({ list, setList, layout, setLayout, memo, setMemo }) {
            const [predefined, setPredefined] = useState([
                { id: 'p1', text: '護照', done: false },
                { id: 'p2', text: 'VJW (Visit Japan Web)', done: false },
                { id: 'p3', text: '網卡 (eSIM) / 漫遊', done: false },
                { id: 'p4', text: '行動電源 & 充電線', done: false }
            ]);
            const toggle = id => setPredefined(predefined.map(item => item.id === id ? { ...item, done: !item.done } : item));
            return (
                <div className="space-y-4">
                    <section className="space-y-3">
                        <div className="flex justify-between items-center px-2">
                            <h3 className="font-serif text-xl font-bold text-text-main flex items-center gap-2">
                                <div className="w-8 h-8 bg-morandi-blue/10 rounded-lg flex items-center justify-center text-morandi-blue">
                                    <ListCheck size={18} />
                                </div>
                                行前準備
                            </h3>
                        </div>
                        <div className="glass-card p-6 space-y-3">
                            {predefined.map(item => (
                                <button key={item.id} onClick={() => toggle(item.id)} className="flex items-center gap-3 w-full text-left">
                                    {item.done ? <CheckCircle2 size={20} className="text-morandi-blue" /> : <Circle size={20} className="text-gray-200" />}
                                    <span className={`text-sm ${item.done ? 'text-gray-300 line-through' : 'text-text-main font-medium'}`}>{item.text}</span>
                                </button>
                            ))}
                        </div>
                    </section>

                    <section className="space-y-3">
                        <div className="flex justify-between items-center px-2">
                            <h3 className="font-serif text-xl font-bold text-text-main flex items-center gap-2">
                                <div className="w-8 h-8 bg-morandi-blue/10 rounded-lg flex items-center justify-center text-morandi-blue">
                                    <ImageIcon size={18} />
                                </div>
                                購物清單
                            </h3>
                        </div>
                        <div className="glass-card p-6 text-center text-text-muted italic text-sm">
                            請在主程式中管理詳細清單
                        </div>
                    </section>

                    <section className="space-y-3">
                        <div className="flex justify-between items-center px-2">
                            <h3 className="font-serif text-xl font-bold text-text-main flex items-center gap-2">
                                <div className="w-8 h-8 bg-morandi-blue/10 rounded-lg flex items-center justify-center text-morandi-blue">
                                    <Smartphone size={18} />
                                </div>
                                個人備忘錄
                            </h3>
                        </div>
                        <div className="glass-card p-6 space-y-4">
                            <textarea 
                                value={memo}
                                onChange={(e) => setMemo(e.target.value)}
                                placeholder="輸入個人筆記、連結或重要資訊..."
                                className="w-full min-h-[120px] bg-morandi-sand/30 p-4 rounded-2xl text-sm outline-none resize-none text-text-main leading-relaxed"
                            />
                        </div>
                    </section>
                </div>
            );
        }

        function InfoTab() {
            return (
                <div className="space-y-8">
                    <div className="glass-card overflow-hidden h-[240px] relative shadow-sm">
                        <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d114515.65485459317!2d127.6186847432049!3d26.24174363381014!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x34e5697141879401%3A0x10dba9a8008405e!2z5rKW57iE!5e0!3m2!1szh-TW!2stw!4v1715600000000!5m2!1szh-TW!2stw" width="100%" height="100%" style={{ border: 0 }} allowFullScreen loading="lazy"></iframe>
                    </div>

                    <div className="glass-card p-6 space-y-5 border border-morandi-sand bg-white shadow-sm">
                        <h3 className="font-serif text-xl font-bold text-text-main flex items-center gap-2">
                            <div className="w-8 h-8 bg-morandi-pink/10 rounded-lg flex items-center justify-center text-morandi-pink">
                                <AlertTriangle size={18} />
                            </div>
                            旅遊禁忌與注意事項
                        </h3>
                        <ul className="space-y-4 text-sm text-text-main leading-relaxed px-2">
                            <li className="flex gap-3">
                                <span className="text-morandi-pink font-bold">01</span>
                                <p><span className="font-bold">出入境違禁品：</span>嚴禁攜帶肉類製品、新鮮蔬果。</p>
                            </li>
                            <li className="flex gap-3">
                                <span className="text-morandi-pink font-bold">02</span>
                                <p><span className="font-bold">自駕規則：</span>沖繩速限較嚴格，切勿違規停車。</p>
                            </li>
                        </ul>
                    </div>

                    <div className="glass-card p-6 space-y-5 border border-morandi-sand bg-white shadow-sm">
                        <h3 className="font-serif text-xl font-bold text-text-main flex items-center gap-2">
                            <div className="w-8 h-8 bg-morandi-blue/10 rounded-lg flex items-center justify-center text-morandi-blue">
                                <Smartphone size={18} />
                            </div>
                            單軌列車 (Yui Rail)
                        </h3>
                        <div className="overflow-x-auto rounded-xl border border-morandi-sand">
                            <img src="https://lh3.googleusercontent.com/d/1vnkzussydV7yR_d5nXTRV8wDW5HMirBQ" className="min-w-[500px]" />
                        </div>
                        <p className="text-xs text-text-main leading-relaxed">
                            • 可使用現金、Suica, ICOCA。<br />
                            • 6歲以下兒童免票。<br />
                            • 飯店位於 11 歌町站。
                        </p>
                    </div>

                    <div className="glass-card p-6 space-y-5 border border-morandi-sand bg-white shadow-sm">
                        <h3 className="font-serif text-xl font-bold text-text-main flex items-center gap-2">
                            <div className="w-8 h-8 bg-morandi-blue/10 rounded-lg flex items-center justify-center text-morandi-blue">
                                <Ticket size={18} />
                            </div>
                            沖繩 FUNPASS
                        </h3>
                        <div className="flex items-center justify-between">
                            <p className="text-xs text-text-main flex-1">一票玩遍沖繩熱門景點！</p>
                            <a href="https://okinawa.funpass.app/" target="_blank" className="w-10 h-10 bg-morandi-blue text-white rounded-xl flex items-center justify-center"><ExternalLink size={18} /></a>
                        </div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>


